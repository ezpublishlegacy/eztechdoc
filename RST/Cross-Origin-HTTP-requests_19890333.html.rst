#. `eZ Publish Platform 5.x <index.html>`__
#. `eZ Publish Platform
   Documentation <eZ-Publish-Platform-Documentation_1114149.html>`__
#. `Development & Administration Guides <6291674.html>`__
#. `Features <Features_12781009.html>`__
#. `Extending eZ Publish 5 <Extending-eZ-Publish-5_1736733.html>`__

eZ Publish Platform 5.x : Cross-Origin HTTP requests
====================================================

Created and last modified by bertrand.dunogier@ez.no on Jan 14, 2014

eZ Publish ships
with \ `NelmioCorsBundle <https://confluence.ez.no/github.com/nelmio/NelmioCorsBundle>`__,
a Symfony open-source bundle that provides support for `CORS (Cross
Origin Resource Sharing) <http://www.w3.org/TR/cors/>`__. The REST API
is pre-configured to respond to such requests, as long as you customize
the allowed origins as explained below.

What is CORS
------------

Supported by most modern browsers, this W3C specification defines a set
of custom headers that, under specific circumstances, allow HTTP
requests between different hosts. The main use-case is execution of AJAX
code from one site towards another.

A couple links about it:

-   `W3C specification <http://www.w3.org/TR/cors/>`__
-  an excellent `tutorial about CORS on
   html5rocks.com <http://www.html5rocks.com/en/tutorials/cors/>`__
-  `overview of CORS on
   developer.mozilla.org <https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS>`__

Configuration
-------------

Since CORS support is provided by a 3rd party bundle, we re-use the
semantical configuration it provides. You can read more about it on the
`NelmiCorsBundle's
README <https://github.com/nelmio/NelmioCorsBundle/blob/master/README.md>`__ file.

The origin of a request is one of the main criteria for allowing or
blocking a cross origin request. Such requests will come with an Origin
HTTP header, automatically added by the browser, that gets
approved/blocked by the server. By default, all cross origin requests
will be blocked.

Granting an origin default access
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To allow a specific host to execute cross-origin requests, you need to
add this host to the ``nelmio_cors.default.allow_origin`` configuration
array in ``config.yml``. As an example, in order to allow requests
from \ `http://example.com, <http://example.com,>`__ one would add those
lines to ``ezpublish/config/config.yml``:

.. code:: theme:

    nelmio_cors:
        defaults:
            allow_origin: [ 'http://example.com' ] 

Granting CORS access to your own HTTP resources
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

| The Cors bundle is of course perfectly safe to use for any non-eZ HTTP
resource you would like to expose.
| Follow the instructions in `NelmioCorsBundle's configuration
chapter <https://github.com/nelmio/NelmioCorsBundle/blob/master/README.md#configuration>`__.

Comments:
---------

+--------------------------------------------------------------------------+
| | If you have problems getting CORS to work and you receive              |
| "Request-Allow-Origin: null" make sure you add 'allowedMethods' to your  |
| corresponding entry in rest\_routes.yml:                                 |
| |                                                                        |
|                                                                          |
| ::                                                                       |
|                                                                          |
|     your_rest_path_identifier:    pattern: /pattern    defaults:         |
| _controller: bundle.controller.default:dosomething        allowedMethods |
| : "OPTIONS,POST"    methods: [POST,OPTIONS]                              |
|                                                                          |
| |image1| Posted by reneh at Oct 20, 2014 16:13                           |
+--------------------------------------------------------------------------+

Document generated by Confluence on Mar 03, 2015 15:12

.. |image0| image:: images/icons/contenttypes/comment_16.png
.. |image1| image:: images/icons/contenttypes/comment_16.png
